#!/usr/bin/env ruby
require 'yaml'
require_relative '../lib/system_check'
require_relative '../lib/notifier'

# Load Configuration
config_path = File.join(File.dirname(__FILE__), '../config/config.yml')

unless File.exist?(config_path)
  puts "‚ùå Config file not found! Please copy config/config.example.yml to config/config.yml"
  exit 1
end

config = YAML.load_file(config_path)

# Run Checks
puts "üîç Sentinel-RB is scanning system..."
checker = SystemCheck.new(config)
alerts = checker.check_all

if alerts.empty?
  puts "‚úÖ System is healthy."
else
  puts "‚ö†Ô∏è Issues found! Sending alerts..."
  notifier = Notifier.new(config)
  notifier.send_alert(alerts)
end
